'use strict';
const config = require('../config.json');
let table = config.table;

const events = require('../events');
const { PrismaClient } = require('@prisma/client')
const prisma = new PrismaClient();
const chalk = require('chalk');

events.on('toIndexer', saveIndexer);

async function saveIndexer(payload) {
  try {
    const event = await prisma.table.create({ data: payload })
    console.log('An Error was added to ErrorHub:', payload.date.toString());
    console.log(chalk.red('-----------------------------------------------------------------------------------------'));
  } catch (e) {
    console.log('Something wrong happened in indexer:', e);
  } finally {
    await prisma.$disconnect();
  }
}

